---
title: Tidy Parallel Loading of Rdata Files
author: ''
date: '2018-06-14'
categories:
    - R
slug: tidy-parallel-loading-of-rdata-files
---

In my last project, I have been using the following function a lot:

```{r fun,include=TRUE,eval=FALSE,echo=TRUE}
load2env <- function(file,env = new.env())
{
  load(file,envir = env)
  env
}

```

This function load the RData file into the environment `env`, which will return. However, if we have multiple files to load simultaneously then we would like to load those files in parallel.

Using the new [furrr](https://github.com/DavisVaughan/furrr) or any other package that allows parallel processing, we can do that by using something as:

```{r load_parallel,include=TRUE,echo=TRUE,eval=FALSE}

library(furrr)

plan(multiprocess)

my_data = tibble(
  files = list.files( my_dir ,full.names = TRUE )) %>% 
  mutate(
    env = map(files,  ~ new.env()),
    data = future_map2( files, env, load2env   ) %>% 
      map(as.list)
  )


```

This command will create the environments in advance, and then load the content of the RData files into them. 


